# 图片水印工具产品需求文档 (PRD)

## 1. 产品概述
本产品是一款运行在Windows平台上的图片水印工具，使用python语言开发。用户可以通过本工具为图片添加自定义文本水印，并支持水印的样式、位置、透明度等多种设置。

## 2. 系统需求
- 操作系统：Windows 10/11
- 开发语言：python

## 3. 功能需求

### 3.1 文件处理
#### 3.1.1 导入图片
- 支持单张图片拖拽或通过文件选择器导入
- 支持批量导入，可一次性选择多张图片或直接导入整个文件夹
- 在界面上显示已导入图片的列表（缩略图和文件名）

#### 3.1.2 支持格式
- 输入格式：JPEG, PNG, BMP（PNG格式必须支持透明通道）
- 输出格式：用户可选择输出为JPEG或PNG

#### 3.1.3 导出图片
- 用户可指定一个输出文件夹。为防止覆盖原图，默认禁止导出到原文件夹
- 提供导出文件命名规则选项：
  - 保留原文件名
  - 添加自定义前缀（如 wm_）
  - 添加自定义后缀（如 _watermarked）

### 3.2 水印类型
#### 3.2.1 文本水印
- 内容：用户可自定义输入任意文本
- 字体：可选择系统已安装的字体、字号、粗体、斜体
- 颜色：提供调色板让用户选择字体颜色
- 透明度：可调节文本的透明度（0-100%）

### 3.3 水印布局与样式
#### 3.3.1 实时预览
- 所有对水印的调整都应在主预览窗口中实时显示效果
- 用户可以点击图片列表切换预览不同的图片

#### 3.3.2 位置
- 预设位置：提供九宫格布局（四角、正中心），用户可一键将水印放置在这些位置
- 手动拖拽：用户可以直接在预览图上通过鼠标拖拽水印到任意位置

#### 3.3.3 旋转（可选高级功能）
- 提供一个滑块或输入框，允许用户以任意角度旋转水印

### 3.4 配置管理
#### 3.4.1 水印模板
- 用户可以将当前的水印设置（包括水印内容、字体、颜色、位置、大小、透明度等所有参数）保存为一个模板
- 用户可以加载、管理和删除已保存的模板
- 程序启动时可自动加载上一次关闭时的设置或一个默认模板

## 4. 界面设计需求
- 简洁直观的用户界面，包含以下主要区域：
  - 图片列表区域：显示已导入图片的缩略图和文件名
  - 预览区域：实时显示水印效果
  - 水印设置区域：包含文本输入、字体选择、颜色选择、透明度调节等控件
  - 位置设置区域：包含预设位置按钮和旋转控制
  - 文件操作区域：包含导入、导出按钮和文件命名规则设置
  - 模板管理区域：包含保存、加载、删除模板的功能

## 5. 技术实现要求
- 使用C++语言开发，确保代码的可读性和可维护性
- 利用Windows API实现文件操作、图形处理和用户界面，无需依赖第三方库
- 确保处理PNG透明通道的正确性
- 实现高效的图片处理算法，确保批量处理的性能
- 合理设计配置文件格式，确保模板数据的正确保存和加载
- 生成的可执行文件可以直接在其他windows 10/11电脑上运行

## 6. 安全与性能
- 防止导出操作覆盖原图
- 确保批量处理大图片时的内存使用合理性
- 提供友好的错误提示，避免程序崩溃
- 确保用户配置和模板数据的安全性

## 7. 测试要求
- 对各种格式图片（JPEG、PNG、BMP）进行测试，确保兼容性
- 对PNG透明通道图片进行特殊测试，确保水印处理不会破坏原图透明度
- 测试不同水印设置组合的效果，确保实时预览的准确性
- 测试批量处理功能，确保稳定性和性能
- 测试模板保存和加载功能，确保配置数据的正确性